# 文件提取与PPT转PDF工具

该工具用于从指定的文件夹中提取 PDF 文件以及将 PPT 文件转换为 PDF，并将它们集中到一个统一的文件夹中。该项目主要实现以下功能：

- 从源文件夹中提取所有 `.pdf` 文件，并将其复制到目标文件夹。
- 将源文件夹中的 `.ppt` 和 `.pptx` 文件转换为 PDF 格式，并保存在目标文件夹中。
- 如果目标文件夹中已存在同名文件，自动为文件重命名（加上数字后缀）。

## 功能

1. **提取 PDF 文件**：遍历指定目录及其子目录，复制所有的 PDF 文件到目标文件夹。
2. **转换 PPT 文件为 PDF**：使用 LibreOffice 将所有 PPT 文件（`.ppt` 和 `.pptx`）转换为 PDF 格式，并保存到目标文件夹。
3. **自动重命名冲突文件**：如果目标文件夹中已有同名文件，脚本会自动为文件添加数字后缀，避免文件覆盖。

## 环境要求

- Python 3.x
- LibreOffice（用于将 PPT 文件转换为 PDF）

## 安装和配置

### 安装依赖

你需要确保安装了以下软件：

- **LibreOffice**：该工具用于从 PPT 文件生成 PDF。如果你尚未安装 LibreOffice，请访问 [LibreOffice 官方网站](https://www.libreoffice.org/) 并下载适合你操作系统的版本。
  
  在安装时，确保勾选了 `soffice` 命令行工具，这样可以通过脚本调用。 **注意需要将LibreOffice放到环境变量中。**


## 使用说明

### 1. 配置源文件夹和目标文件夹

在 `main.py` 中，设置源文件夹路径 `source_directory` 和目标文件夹路径 `target_directory`。例如：

```python
source_directory = 'D:/reading/金融/经济学原理/课件'  # 源文件夹路径
target_directory = 'D:/reading/金融/经济学原理/集成课件'  # 目标文件夹路径
```

### 2. 运行脚本

在终端或命令提示符中，进入脚本所在目录并运行以下命令：

```bash
python main.py
```

该脚本会遍历 `source_directory` 目录中的所有文件夹，复制所有 PDF 文件，并将 PPT 文件转换为 PDF，最终将它们保存在 `target_directory` 中。

## 示例

假设你的源文件夹结构如下：

```
课件/
├── 文件夹1/
│   ├── 课件1.ppt
│   └── 文件1.pdf
├── 文件夹2/
│   ├── 课件2.pptx
│   └── 文件2.pdf
└── 文件夹3/
    ├── 课件3.ppt
    └── 文件3.pdf
```

在这种结构下，脚本会遍历 `课件/` 文件夹及其子文件夹，提取其中的 PDF 文件，并将 PPT 文件转换为 PDF，然后把它们都保存到目标文件夹。

运行脚本后，目标文件夹会包含：

```
集成课件/
├── 文件1.pdf
├── 文件2.pdf
├── 文件3.pdf
├── 课件1.pdf
├── 课件2.pdf
└── 课件3.pdf
```



如果目标文件夹中已存在同名文件（例如 `文件1.pdf`），脚本会将其重命名为 `文件1_1.pdf` 以避免冲突。

## 注意事项

- 请确保 `soffice` 命令在系统环境变量中可用。你可以通过在终端中运行 `soffice --version` 来验证。
- 如果你遇到文件权限或路径错误，确保你具有适当的读写权限，并且文件路径没有空格或特殊字符。

## 问题反馈

如果你在使用过程中遇到任何问题，请随时提出 [issue](https://github.com/yourusername/yourrepo/issues) 或联系项目维护者。

## 贡献

欢迎贡献代码！如果你有任何建议或改进，可以提交 Pull Request 或提出 Issue。

## 许可证

该项目采用 [MIT 许可证](https://opensource.org/licenses/MIT)。


### 说明：
- **功能概述**：简要描述了脚本的功能。
- **环境要求**：列出了脚本运行所需的 Python 和 LibreOffice 环境。
- **安装和配置**：指导用户如何安装依赖项。
- **使用说明**：提供了详细的使用步骤，包括配置源文件夹和目标文件夹，运行脚本的步骤。
- **示例**：给出了一个源文件夹和目标文件夹的示例，帮助用户了解脚本的行为。
- **注意事项**：提醒用户检查 `soffice` 命令是否可用等事项。
- **问题反馈**：用户如遇到问题时的反馈途径。
- **贡献**：鼓励其他开发者参与项目贡献。
- **许可证**：项目的许可证信息。

